define(["../core","../var/support","../ajax"],function(e,t){e.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var r=0,n={},o={0:200,1223:204},s=e.ajaxSettings.xhr();window.ActiveXObject&&e(window).on("unload",function(){for(var e in n)n[e]()}),t.cors=!!s&&"withCredentials"in s,t.ajax=s=!!s,e.ajaxTransport(function(e){var a;return t.cors||s&&!e.crossDomain?{send:function(t,s){var i,u=e.xhr(),d=++r;if(u.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)u[i]=e.xhrFields[i];e.mimeType&&u.overrideMimeType&&u.overrideMimeType(e.mimeType),e.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest");for(i in t)u.setRequestHeader(i,t[i]);a=function(e){return function(){a&&(delete n[d],a=u.onload=u.onerror=null,"abort"===e?u.abort():"error"===e?s(u.status,u.statusText):s(o[u.status]||u.status,u.statusText,"string"==typeof u.responseText?{text:u.responseText}:void 0,u.getAllResponseHeaders()))}},u.onload=a(),u.onerror=a("error"),a=n[d]=a("abort");try{u.send(e.hasContent&&e.data||null)}catch(c){if(a)throw c}},abort:function(){a&&a()}}:void 0})});